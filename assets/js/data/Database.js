/**
 * Database.js
 * Handles the Mock API data and local storage simulation.
 */
const mockApiDatabase = {
    'the future of ai': {
        title: 'The Future of Artificial Intelligence',
        meta: 'Topic Complexity: High | Source: Global Tech Aggregator',
        lastUpdated: Date.now(),
        sections: [
            { type: 'h2', content: 'The AI Revolution' },
            { type: 'p', content: 'Artificial Intelligence (AI) is poised to redefine industries, economies, and human experiences. This page synthesizes the latest projections and expert opinions on its trajectory.' },
            { type: 'image', src: 'https://picsum.photos/seed/ai-future/800/400', alt: 'Futuristic AI concept' },
            { type: 'callout', content: 'Key takeaway: AI impact will be pervasive, with significant advancements expected in machine learning, natural language processing, and robotics.' },
            { type: 'h2', content: 'Comparative Analysis of AI Models' },
            { type: 'table', headers: ['Model Type', 'Primary Use Case', 'Development Status'], rows: [
                ['GANs', 'Image Generation', 'Rapidly Evolving'],
                ['Transformers', 'NLP (GPT)', 'State-of-the-Art'],
                ['RL', 'Autonomous Systems', 'Mature']
            ]}
        ]
    },
    'default': {
        title: 'Dynamically Generated Page',
        meta: 'Generated by Weaver Engine',
        sections: [
            { type: 'h2', content: 'Introduction' },
            { type: 'p', content: 'The Weaver has aggregated content from multiple high-ranking sources to create this summary.' },
            { type: 'image', src: 'https://picsum.photos/seed/dynamic/800/400', alt: 'Abstract Topic' },
            { type: 'p', content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integrating best-in-class data sources.' },
            { type: 'list', items: ['Key Insight 1', 'Statistical Analysis', 'Expert Opinion'] }
        ]
    }
};

export const Database = {
    /**
     * Simulate fetching from an external API
     */
    fetchFromWeb: (queryKey) => {
        return new Promise((resolve) => {
            console.log(`[Database] Scanning web for: ${queryKey}...`);
            setTimeout(() => {
                const data = mockApiDatabase[queryKey] || {
                    ...mockApiDatabase.default,
                    title: queryKey.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')
                };
                resolve(data);
            }, 1000); // 1s latency
        });
    },

    /**
     * Save page to local "cache" (in-memory for now, LocalStorage next iteration)
     */
    saveToCache: (key, data) => {
        // In this iteration, we just return the data, 
        // next iteration we implement actual persistence.
        console.log(`[Database] Caching result for ${key}`);
        return data;
    }
};